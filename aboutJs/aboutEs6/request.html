<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>fetch请求 | zhanglc个人主页</title>
    <meta name="description" content="前端请求数据的方法">
    <link rel="icon" href="/zlc-blog/logo.jpg">
    <meta name="keywords" content="es6,fetch,ajax">
    <link rel="preload" href="/zlc-blog/assets/css/0.styles.32c68d3c.css" as="style"><link rel="preload" href="/zlc-blog/assets/js/app.6100065f.js" as="script"><link rel="preload" href="/zlc-blog/assets/js/23.88b4302f.js" as="script"><link rel="prefetch" href="/zlc-blog/assets/js/1.c87db1b4.js"><link rel="prefetch" href="/zlc-blog/assets/js/10.19d174b6.js"><link rel="prefetch" href="/zlc-blog/assets/js/11.7af2b0b8.js"><link rel="prefetch" href="/zlc-blog/assets/js/12.04871506.js"><link rel="prefetch" href="/zlc-blog/assets/js/13.32c9c228.js"><link rel="prefetch" href="/zlc-blog/assets/js/14.34c4d234.js"><link rel="prefetch" href="/zlc-blog/assets/js/15.4dc7fa03.js"><link rel="prefetch" href="/zlc-blog/assets/js/16.198ce758.js"><link rel="prefetch" href="/zlc-blog/assets/js/17.bbf95844.js"><link rel="prefetch" href="/zlc-blog/assets/js/18.a212a5d4.js"><link rel="prefetch" href="/zlc-blog/assets/js/19.c735edcf.js"><link rel="prefetch" href="/zlc-blog/assets/js/20.8ba5e936.js"><link rel="prefetch" href="/zlc-blog/assets/js/21.6d282839.js"><link rel="prefetch" href="/zlc-blog/assets/js/22.fd72d617.js"><link rel="prefetch" href="/zlc-blog/assets/js/24.a6844b30.js"><link rel="prefetch" href="/zlc-blog/assets/js/25.2e07815c.js"><link rel="prefetch" href="/zlc-blog/assets/js/26.f3eaca70.js"><link rel="prefetch" href="/zlc-blog/assets/js/27.c9fb41ed.js"><link rel="prefetch" href="/zlc-blog/assets/js/28.f2c25e81.js"><link rel="prefetch" href="/zlc-blog/assets/js/29.e940cafc.js"><link rel="prefetch" href="/zlc-blog/assets/js/3.0fd6f489.js"><link rel="prefetch" href="/zlc-blog/assets/js/30.6c51a9f5.js"><link rel="prefetch" href="/zlc-blog/assets/js/31.3d8ad7ad.js"><link rel="prefetch" href="/zlc-blog/assets/js/32.c87a3306.js"><link rel="prefetch" href="/zlc-blog/assets/js/33.0a962236.js"><link rel="prefetch" href="/zlc-blog/assets/js/34.292d6d45.js"><link rel="prefetch" href="/zlc-blog/assets/js/35.7cdb0bc7.js"><link rel="prefetch" href="/zlc-blog/assets/js/36.0b1c0af5.js"><link rel="prefetch" href="/zlc-blog/assets/js/37.b1f79be8.js"><link rel="prefetch" href="/zlc-blog/assets/js/38.163219df.js"><link rel="prefetch" href="/zlc-blog/assets/js/39.e2291e25.js"><link rel="prefetch" href="/zlc-blog/assets/js/4.f6ab7665.js"><link rel="prefetch" href="/zlc-blog/assets/js/40.f4bf3293.js"><link rel="prefetch" href="/zlc-blog/assets/js/41.9ee76abe.js"><link rel="prefetch" href="/zlc-blog/assets/js/42.12f30a3b.js"><link rel="prefetch" href="/zlc-blog/assets/js/43.2c11cef9.js"><link rel="prefetch" href="/zlc-blog/assets/js/44.be511023.js"><link rel="prefetch" href="/zlc-blog/assets/js/45.5e68836d.js"><link rel="prefetch" href="/zlc-blog/assets/js/46.dcf07653.js"><link rel="prefetch" href="/zlc-blog/assets/js/47.598889c8.js"><link rel="prefetch" href="/zlc-blog/assets/js/5.e203aa1a.js"><link rel="prefetch" href="/zlc-blog/assets/js/6.b25fa37c.js"><link rel="prefetch" href="/zlc-blog/assets/js/7.5d500630.js"><link rel="prefetch" href="/zlc-blog/assets/js/8.47f42958.js"><link rel="prefetch" href="/zlc-blog/assets/js/9.04a9874d.js">
    <link rel="stylesheet" href="/zlc-blog/assets/css/0.styles.32c68d3c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zlc-blog/" class="home-link router-link-active"><!----> <span class="site-name">zhanglc个人主页</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">web</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutJs/" class="nav-link router-link-active">aboutJs</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutVue/" class="nav-link">aboutVue</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutCss/" class="nav-link">aboutCss</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/optimize/optimize.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="/zlc-blog/counter/" class="nav-link">counter</a></div><div class="nav-item"><a href="/zlc-blog/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zlc140" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">web</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutJs/" class="nav-link router-link-active">aboutJs</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutVue/" class="nav-link">aboutVue</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutCss/" class="nav-link">aboutCss</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/optimize/optimize.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="/zlc-blog/counter/" class="nav-link">counter</a></div><div class="nav-item"><a href="/zlc-blog/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zlc140" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Js相关知识</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>ES6相关知识</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/zlc-blog/aboutJs/aboutEs6/es6.html" class="sidebar-link">es6处理数据的方法</a></li><li><a href="/zlc-blog/aboutJs/aboutEs6/generator.html" class="sidebar-link">generator</a></li><li><a href="/zlc-blog/aboutJs/aboutEs6/request.html" class="active sidebar-link">fetch请求</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zlc-blog/aboutJs/aboutEs6/request.html#什么是ajax" class="sidebar-link">什么是AJAX</a></li><li class="sidebar-sub-header"><a href="/zlc-blog/aboutJs/aboutEs6/request.html#ajax" class="sidebar-link">$.ajax</a></li><li class="sidebar-sub-header"><a href="/zlc-blog/aboutJs/aboutEs6/request.html#axios" class="sidebar-link">axios</a></li><li class="sidebar-sub-header"><a href="/zlc-blog/aboutJs/aboutEs6/request.html#fetch" class="sidebar-link">Fetch</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>TS相关知识</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="什么是ajax">什么是AJAX</h2> <p>AJAX代表异步JavaScript和XML，它允许应用程序通过与Web服务器交换数据来异步更新网页。</p> <p><strong>AJAX是一个误导性的名称。AJAX应用程序可能使用XML来传输数据，但将数据作为纯文本或JSON文本传输同样很常见。 - w3shools.com</strong></p> <p><code>XMLHttpRequest</code>的实例对象的属性都在prototype上有10个普通属性和9个方法</p> <p>设置<code>requestHeader</code>的值</p> <ol><li><p><strong><code>Content-type</code>:</strong><br>
a. 发送json数据格式<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;application/json; charset=utf-8&quot;)</code><br>
b. 发送表单数据<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded; charset=utf-8&quot;);</code><br>
c. 发送纯文本（不设置content-type ,默认此值）<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;text/plain; charset=utf-8&quot;);</code><br>
d. 发送HTML文本<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;text/html; charset=utf-8&quot;);</code><br>
e. 可以不带编码<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;application/json&quot;);</code><br>
f. 对大小写不敏感<br> <code>xhr.setRequestHeader(&quot;Content-type&quot;,&quot;Application/JSON; charset=utf-8&quot;);</code></p></li> <li><p><strong><code>Cache-Control: xhr.setRequestHeader('Cache-Control', '')</code></strong><br>
a. <code>no-cache</code>  在发布缓存副本之前，强制要求缓存把请求提交给原始服务器进行验证。<br>
b. <code>public</code> 可以被任何对象（客户端，代理服务器等）缓存，即使是通常不可缓存的内容如（该响应没有max-age指令或Expires消息头）<br>
c. <code>private</code> 只能单个用户缓存，即不能被代理服务器缓存。<br>
d. <code>no-store</code> 缓存不应存储有关客户端请求或服务器响应的任何内容。<br>
e. <code>max-age(seconds)</code> 缓存最大时间<br>
f. <code>xhr.setRequeryHeader('Cache-Control':'public, max-age=31536000')</code>缓存静态资源<br>
g. <code>Cache-Control: no-cache, no-store, must-revalidate</code> 关闭缓存</p></li> <li><p><strong><code>XMLHttpRequest</code>的属性</strong><br>
a. <code>readyState</code> 只读属性（0：请求建立，未初始化；1：初始化（以掉open,未send）;2:发送数据send; 3:数据传输中loading;4.完成）<br>
b. <code>status</code> 只读；表示HTTP请求状态对应http请求状态码<br>
c. <code>statusText</code> 服务器响应状态信息 status==200X时放回'OK',失败为null,301的 Moved Permanently , 302的 Found , 303的 See Other , 307 的 Temporary Redirect , 400的 Bad Request , 401的 Unauthorized 等等<br>
e. <code>timeout</code> 值为大于0数字，指定ajax请求超时时长<br>
f. <code>response</code> <code>responseText</code> 均为服务器响应内容<br>
g. <code>responseXML</code> 服务器响应xml的内容<br>
h. <code>responseType</code> 响应类型 缺省为空字符串, 可取 &quot;arraybuffer&quot; , &quot;blob&quot; , &quot;document&quot; , &quot;json&quot; , and &quot;text&quot; 共五种类型.<br>
I. <code>responseURL</code> 返回ajax请求最终的URL, 如果请求中存在重定向, 那么responseURL表示重定向之后的URL.<br>
J. <code>withCredentials</code> 布尔，默认false  表示跨域请求中不发送cookies等信息,为true则发。对同域无影响<br>
k. <code>upload</code>  属性默认返回一个 <code>XMLHttpRequestUpload</code> 对象, 用于上传资源</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>xhr<span class="token punctuation">.</span>upload<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> e<span class="token punctuation">.</span>loaded <span class="token operator">/</span> e<span class="token punctuation">.</span>total <span class="token operator">|</span><span class="token number">0</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'upload: '</span> <span class="token operator">+</span> precent <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><ol start="4"><li><code>XMLHttpRequest</code>的方法
a. <code>onreadystatechange</code> 该方法回调在<code>readyState</code>改变时调用
b. <code>onloadstart</code> 触发在发送请求之前，readyState=1之后触发，包含一个<code>ProgressEvent</code>事件进度对象（lengthComputable布尔，资源长度是否可计算；loaded加载资源的大小；total总资源大小）
c. <code>onprogress</code> readyState==3 状态时开始触发 默认传入 <code>ProgressEvent</code> 对象 资源加载进度 <code>e.loaded/e.total</code>;
d. <code>onload</code> 调方法在ajax请求成功后触发 <code>readyState==4</code> 状态之后. 可以来捕捉一个ajax请求成功
e. <code>onloadend</code> <code>readyState==4</code>或<code>readyState==2</code>（未响应）触发 默认传<code>ProgressEvent</code>对象
f. <code>ontimeout</code> 请求超时时触发
g. <code>abort()</code> 用于取消ajax 请求取消后  readyState 状态将被设置为 0 (<code>UNSENT</code>)
h. <code>getResponseHeader</code> 获取ajax响应头中指定name的值 <code>console.log(xhr.getResponseHeader('Content-Type'));//&quot;text/html&quot;</code>
i. <code>getAllResponseHeaders</code> 获取所有安全的ajax响应  响应头以字符串形式返回
j. <code>setRequestHeader()</code> 设置请求头
k. <code>onerror</code> 请求出错执行
l. <code>overrideMimeType</code> 用于强制指定<code>response</code> 的 MIME 类型</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;text/plain&quot;</span>
xhr<span class="token punctuation">.</span><span class="token function">overrideMimeType</span><span class="token punctuation">(</span><span class="token string">&quot;text/xml; charset = utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;text/xml; charset = utf-8&quot;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">function</span> <span class="token function">requery</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> options<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xmlhttp<span class="token punctuation">;</span>
    <span class="token keyword">let</span> method <span class="token operator">=</span> options<span class="token punctuation">.</span>method <span class="token operator">||</span> <span class="token string">'GET'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> async <span class="token operator">=</span> options<span class="token punctuation">.</span>async <span class="token operator">||</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//是否异步</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> options<span class="token punctuation">.</span>data
    <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//IE7+,Firefox, Chrome, Opera, Safari</span>
        xmlhttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//IE5,6</span>
        xmlhttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLHTTP&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'GET'</span> <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        Object<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span>
            props<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">'?'</span> <span class="token operator">+</span> props<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            url <span class="token operator">=</span> url <span class="token operator">+</span> props<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    xmlhttp<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> async<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        xmlhttp<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">)</span>
        xmlhttp<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        xmlhttp<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded;charset=utf-8'</span><span class="token punctuation">)</span>
        xmlhttp<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    
<span class="token punctuation">}</span>

</code></pre></div><h2 id="ajax">$.ajax</h2> <p>jquery对原生ajax的一次封装,统一了ajax的api，不用再考虑不同浏览器的兼容差异</p> <div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    async<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否异步，默认true异步</span>
    <span class="token function-variable function">beforeSend</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//添加自定义http头</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    dataType<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">//预期服务器返回的数据类型。</span>
    jsonp<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a href="http://www.w3school.com.cn/jquery/ajax_ajax.asp" target="_blank" rel="noopener noreferrer">jQuery的ajax请求的详细参数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="axios">axios</h2> <ol><li>axios支持node,浏览器</li> <li>体积小,仅12k</li> <li>基于promise</li> <li>请求可以拦截请求和响应</li> <li>可取消、</li> <li>客户端支持防御XSRF</li> <li>已整合了vue和react,nuxt等框架</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    mobile<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'/user/12345'</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> <span class="token string">'Flintstone'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://www.jianshu.com/p/7a9fbcbb1114" target="_blank" rel="noopener noreferrer">axios接口文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://www.axios-js.com/" target="_blank" rel="noopener noreferrer">axios+框架接口文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="fetch">Fetch</h2> <p>fetch是web异步通信的未来,在大部分现代浏览器（除IE)开箱即用，受js生态系统的支持
因此fetch未来很可能真正取代ajax,直接成为web api</p> <p>fetch()方法传入url,返回一个处理response 的 Promise,不论成功失败都会放回到promise</p> <p>浏览器的支持：从chrome42, Firefox39, Opera29, EdgeHTML1起支持
对于不支持的的许多浏览器需要添加添加polyfill(垫片)</p> <ul><li>es5的polyfill : <a href="https://github.com/es-shims/es5-shim" target="_blank" rel="noopener noreferrer">es5-shim<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/es-shims/es5-sham" target="_blank" rel="noopener noreferrer">es5-sham<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Promise的polyfill: <a href="https://github.com/stefanpenner/es6-promise" target="_blank" rel="noopener noreferrer">es6-promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>fetch的polyfill: <a href="https://github.com/camsong/fetch-ie8" target="_blank" rel="noopener noreferrer">fetch-ie8<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
如果要支持ie8+,以上三个建议都添加<br>
fetch一般有两个参数，第一个是请求地址，第二个是请求设置</li> <li>header</li></ul> <ul><li>fetch的响应头</li></ul> <blockquote><p>获取响应头： response.headers.get('Content-Type')</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 设置头</span>
<span class="token keyword">var</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
headers<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token punctuation">{</span>
  headers<span class="token punctuation">:</span> headers
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>credentials
fetch的请求默认是不带cookie的，需要手动设置，include（带cookie）;omit: 缺省值, 默认为该值.same-origin: 同源, 表示同域请求才发送cookie.</p></li> <li><p>catch 处理缓存，同ajax</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=%27+123+%27&amp;json=1&amp;p=3'</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token comment">//POST，GET，DELETE，UPDATE，PATCH和PUT</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//header也可直接在这里设置</span>
    mode<span class="token punctuation">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span> <span class="token comment">// no-cors(不跨域)，cors(跨域)，same-origin(同域才会发送该fetch),cors-with-forced-preflight: 表示在发出请求前, 将执行preflight检查. （navigate , websocket）也是两个特殊值</span>
    credentials<span class="token punctuation">:</span> <span class="token string">'include'</span><span class="token punctuation">,</span> <span class="token comment">//</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span>json
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>fetch的不足，</p> <ul><li>api简单</li> <li>fetch基于promise，也受限于promise,兼容方面需要安装相关垫片，</li> <li>fetch无法停止（没有ajax的abort方法）</li> <li>不支持timeout机制</li> <li>虽然没有回调嵌套的问题，但也会有then链接过长的问题，没有deferred（async/await）</li> <li>没有progress提示</li></ul></li> <li><p>不足的补充</p> <ul><li>fetch-jsonp 支持jsonp</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">fetchJsonp</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  timeout<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
  jsonpCallback<span class="token punctuation">:</span> <span class="token string">'callback'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>abort()使用promise.race()来实现</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> _fetch <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fetch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> abort <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> timeout <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        
        <span class="token keyword">let</span> abort_Promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
             <span class="token function-variable function">abort</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                 <span class="token keyword">let</span> val <span class="token operator">=</span> e <span class="token operator">||</span> <span class="token string">'abort'</span>
                <span class="token function">reject</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'abort done'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">,</span>
            abort_Promise
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        promise<span class="token punctuation">.</span>abort <span class="token operator">=</span> abort<span class="token punctuation">;</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> <span class="token string">'timeout'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> timeout
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ts<span class="token operator">=</span><span class="token operator">+</span>ts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    timeout <span class="token operator">=</span> ts<span class="token punctuation">;</span>
                    <span class="token function">setTimeout</span><span class="token punctuation">(</span>abort<span class="token punctuation">,</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token function">_fetch</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">1</span>
p<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>fetch请求后, 立即调用abort方法, 该promise被拒绝, 符合预期,注意：abort()方法是另写的，没有写在then方法中，因为then返回的是一个新的promise对象</p> <ul><li>timeout 通过Promise.race实现</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//简易版</span>
<span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//return new Promise((resolve, reject) =&gt; {</span>
    <span class="token comment">//    setTimeout(function() {</span>
    <span class="token comment">//        reject('timeout')</span>
    <span class="token comment">//    }, time)</span>
    <span class="token comment">//})</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token punctuation">,</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/zlc-blog/aboutJs/aboutEs6/generator.html" class="prev">
          generator
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/zlc-blog/assets/js/app.6100065f.js" defer></script><script src="/zlc-blog/assets/js/23.88b4302f.js" defer></script>
  </body>
</html>
