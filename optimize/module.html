<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端模块化 | zhanglc个人主页</title>
    <meta name="description" content="前端模块化">
    <link rel="icon" href="/zlc-blog/logo.jpg">
    <meta name="keywords" content="AMD,CMD,UMD,Commonjs,Es Module,前端模块化">
    <link rel="preload" href="/zlc-blog/assets/css/0.styles.32c68d3c.css" as="style"><link rel="preload" href="/zlc-blog/assets/js/app.6100065f.js" as="script"><link rel="preload" href="/zlc-blog/assets/js/44.be511023.js" as="script"><link rel="prefetch" href="/zlc-blog/assets/js/1.c87db1b4.js"><link rel="prefetch" href="/zlc-blog/assets/js/10.19d174b6.js"><link rel="prefetch" href="/zlc-blog/assets/js/11.7af2b0b8.js"><link rel="prefetch" href="/zlc-blog/assets/js/12.04871506.js"><link rel="prefetch" href="/zlc-blog/assets/js/13.32c9c228.js"><link rel="prefetch" href="/zlc-blog/assets/js/14.34c4d234.js"><link rel="prefetch" href="/zlc-blog/assets/js/15.4dc7fa03.js"><link rel="prefetch" href="/zlc-blog/assets/js/16.198ce758.js"><link rel="prefetch" href="/zlc-blog/assets/js/17.bbf95844.js"><link rel="prefetch" href="/zlc-blog/assets/js/18.a212a5d4.js"><link rel="prefetch" href="/zlc-blog/assets/js/19.c735edcf.js"><link rel="prefetch" href="/zlc-blog/assets/js/20.8ba5e936.js"><link rel="prefetch" href="/zlc-blog/assets/js/21.6d282839.js"><link rel="prefetch" href="/zlc-blog/assets/js/22.fd72d617.js"><link rel="prefetch" href="/zlc-blog/assets/js/23.88b4302f.js"><link rel="prefetch" href="/zlc-blog/assets/js/24.a6844b30.js"><link rel="prefetch" href="/zlc-blog/assets/js/25.2e07815c.js"><link rel="prefetch" href="/zlc-blog/assets/js/26.f3eaca70.js"><link rel="prefetch" href="/zlc-blog/assets/js/27.c9fb41ed.js"><link rel="prefetch" href="/zlc-blog/assets/js/28.f2c25e81.js"><link rel="prefetch" href="/zlc-blog/assets/js/29.e940cafc.js"><link rel="prefetch" href="/zlc-blog/assets/js/3.0fd6f489.js"><link rel="prefetch" href="/zlc-blog/assets/js/30.6c51a9f5.js"><link rel="prefetch" href="/zlc-blog/assets/js/31.3d8ad7ad.js"><link rel="prefetch" href="/zlc-blog/assets/js/32.c87a3306.js"><link rel="prefetch" href="/zlc-blog/assets/js/33.0a962236.js"><link rel="prefetch" href="/zlc-blog/assets/js/34.292d6d45.js"><link rel="prefetch" href="/zlc-blog/assets/js/35.7cdb0bc7.js"><link rel="prefetch" href="/zlc-blog/assets/js/36.0b1c0af5.js"><link rel="prefetch" href="/zlc-blog/assets/js/37.b1f79be8.js"><link rel="prefetch" href="/zlc-blog/assets/js/38.163219df.js"><link rel="prefetch" href="/zlc-blog/assets/js/39.e2291e25.js"><link rel="prefetch" href="/zlc-blog/assets/js/4.f6ab7665.js"><link rel="prefetch" href="/zlc-blog/assets/js/40.f4bf3293.js"><link rel="prefetch" href="/zlc-blog/assets/js/41.9ee76abe.js"><link rel="prefetch" href="/zlc-blog/assets/js/42.12f30a3b.js"><link rel="prefetch" href="/zlc-blog/assets/js/43.2c11cef9.js"><link rel="prefetch" href="/zlc-blog/assets/js/45.5e68836d.js"><link rel="prefetch" href="/zlc-blog/assets/js/46.dcf07653.js"><link rel="prefetch" href="/zlc-blog/assets/js/47.598889c8.js"><link rel="prefetch" href="/zlc-blog/assets/js/5.e203aa1a.js"><link rel="prefetch" href="/zlc-blog/assets/js/6.b25fa37c.js"><link rel="prefetch" href="/zlc-blog/assets/js/7.5d500630.js"><link rel="prefetch" href="/zlc-blog/assets/js/8.47f42958.js"><link rel="prefetch" href="/zlc-blog/assets/js/9.04a9874d.js">
    <link rel="stylesheet" href="/zlc-blog/assets/css/0.styles.32c68d3c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zlc-blog/" class="home-link router-link-active"><!----> <span class="site-name">zhanglc个人主页</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">web</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutJs/" class="nav-link">aboutJs</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutVue/" class="nav-link">aboutVue</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutCss/" class="nav-link">aboutCss</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/optimize/optimize.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="/zlc-blog/counter/" class="nav-link">counter</a></div><div class="nav-item"><a href="/zlc-blog/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zlc140" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">web</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutJs/" class="nav-link">aboutJs</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutVue/" class="nav-link">aboutVue</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/aboutCss/" class="nav-link">aboutCss</a></li><li class="dropdown-item"><!----> <a href="/zlc-blog/optimize/optimize.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="/zlc-blog/counter/" class="nav-link">counter</a></div><div class="nav-item"><a href="/zlc-blog/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zlc140" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>性能优化</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/zlc-blog/optimize/" class="sidebar-link">性能优化</a></li><li><a href="/zlc-blog/optimize/optimize.html" class="sidebar-link">前端优化之reflow</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p>规范化JavaScript的模块定义和加载机制，减低了学习和使用各种框架的门槛，能够以一种统一的方式去定义和使用模块
，提高开发效率，减低了应用维护成本。</p> <h2 id="amd">AMD</h2> <ol><li>异步模块定义（Asynchronous Module Defintion）实例requirejs</li> <li>requireJS推广过程中的对模块化定义的规范化产出</li> <li>推崇依赖前置</li> <li>以浏览器为第一的原则发展，异步加载模块</li> <li>模块依赖如何确定： 运行时</li> <li>目的：
a. 解决前端页面有多个js时，相互之间依赖关系复杂导致js顺序管理越发麻烦，
b. 异步加载，避免加载多个js会导致浏览器停止渲染假死</li> <li>模块必须采用特定的define()函数来定义</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//定义模块 </span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">jquery</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//调用模块 相当于加载jQuery成功之后执行回调</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span>module<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// data-main属性的作用是，指定网页程序的主模块。
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/require.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-main</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// math.js define和require一样是两个参数，一个是依赖的数组，第二个是函数主体</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
　　　　<span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
　　　　　　<span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span> 
　　　　<span class="token punctuation">}</span><span class="token punctuation">;</span> 
　　　　<span class="token keyword">return</span> <span class="token punctuation">{</span> 
　　　　　　add<span class="token punctuation">:</span> add
　　　　<span class="token punctuation">}</span><span class="token punctuation">;</span> 
　　<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">// 主模块写法main.js</span>
require<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
　　　　baseUrl<span class="token punctuation">:</span> <span class="token string">&quot;js/lib&quot;</span><span class="token punctuation">,</span> 
　　　　paths<span class="token punctuation">:</span> <span class="token punctuation">{</span> 
　　　　　　<span class="token string">&quot;jquery&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;jquery.min&quot;</span><span class="token punctuation">,</span>
　　　　　　<span class="token string">&quot;backbone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;backbone.min&quot;</span> <span class="token punctuation">,</span>
           <span class="token string">&quot;math&quot;</span><span class="token punctuation">:</span> <span class="token string">'js/math'</span>
　　　　<span class="token punctuation">}</span><span class="token punctuation">,</span>
        shim<span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment">//专门用来配置不兼容的模块（不符合AMD规范的库）</span>
　　　　　　<span class="token string">'underscore'</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
　　　　　　　　exports<span class="token punctuation">:</span> <span class="token string">'_'</span>
　　　　　　<span class="token punctuation">}</span><span class="token punctuation">,</span> 
　　　　　　<span class="token string">'backbone'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
　　　　　　　　deps<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'underscore'</span><span class="token punctuation">,</span> <span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
　　　　　　　　exports<span class="token punctuation">:</span> <span class="token string">'Backbone'</span>
　　　　　　<span class="token punctuation">}</span> 
　　　　<span class="token punctuation">}</span>
　　<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">,</span><span class="token string">'backbone'</span><span class="token punctuation">,</span> <span class="token string">'math'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">jquery<span class="token punctuation">,</span> backbone<span class="token punctuation">,</span> math</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// some code hear</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="cmd">CMD</h2> <ol><li>通用模块定义前端运用（Common Module Definition）,实例seajs</li> <li>seajs推广过程中的对模块化定义的规范化产出</li> <li>推崇依赖就近，推崇一个页面一个模块，遵循统一写法</li> <li>解决的问题和AMD一样，都是为浏览器而生的</li> <li>和AMD的区别是模块加载时机的不同</li> <li>第三方引入</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例如JQuery，这个加好之后添加别名</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// jquery 源码</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="7"><li>一个seajs项目的根目录会有个文件夹sea-module,存放的依赖模块，这个项目的根目录是 c:/project/test/sea-module</li> <li>模块暴露接口的方法： exports, module.exports, return, 如何都没有，默认导出{},require默认导出undefined</li> <li>预先下载，延迟执行</li></ol> <div class="language-sea-module extra-class"><pre class="language-text"><code>seajs example
|--seajs
    |--sea-module       //存在依赖文件
        |--jquery
            |--jqeury.js
        |--sea.js    
    |--static         //存放自定义模块js
        |--main.js
        |--changeText.js
    |--index.html     //调用页面
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sea-module/sea.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// 设置别名，要在use之前设置</span>
    seajs<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        alias<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token string">'matn'</span><span class="token punctuation">:</span><span class="token string">'../js/math.js'</span><span class="token punctuation">,</span>
            <span class="token string">'jquery'</span><span class="token punctuation">:</span> <span class="token string">'jQuery/jquery.js'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// seajs.use('./js/main.js');</span>
    seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'math'</span><span class="token punctuation">,</span> <span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">math<span class="token punctuation">,</span>$</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// math.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    　　　　　　<span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span> 
　　　　<span class="token punctuation">}</span><span class="token punctuation">;</span> 
       <span class="token comment">// 模块导出方法</span>
       <span class="token comment">//exports.add = add;</span>
　　　　module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
　　　　　　add<span class="token punctuation">:</span> add
　　　　<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//return {</span>
         <span class="token comment">//   add: add</span>
        <span class="token comment">//}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// main.js</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'math'</span><span class="token punctuation">)</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="commonjs">Commonjs</h2> <ol><li>服务端模块的规范，node采用了这个规范</li> <li>同步加载模块，加载完才执行之后的操作（例如node主要用于服务器编程，文件一般都已经存在于硬盘上，加载快）</li> <li>加载方式：整体加载，一个文件一个模块，加载使用require方法读取文件并执行，最后返回exports对象</li> <li>模块导出 module.exports,exports都可以，exports = module.exports = {}</li> <li>输出的是值拷贝，不存在动态更新</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// foobar.js</span>
<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">//私有变量</span>
<span class="token keyword">function</span> <span class="token function">Foobar</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'haha'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'gggg'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> foobar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foobar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//module.exports = {</span>
  <span class="token comment">//  foobar : foobar</span>
<span class="token comment">//}</span>
exports<span class="token punctuation">.</span>foobar <span class="token operator">=</span> foobar

<span class="token comment">// main.js使用   require默认读取js文件</span>
<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./foobar'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foobar
test<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="umd">UMD</h2> <ol><li>跨平台的解决方案（Universal Module Definition） 是AMD和CommonJS的糅合</li> <li>先判断是否支持Node.js的模块（exports）是否存在，存在则使用Node.js模块模式。再判断是否支持AMD（define是否存在），存在则使用AMD方式加载模块。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     
        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     
        <span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     
        window<span class="token punctuation">.</span>eventUtil <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//module ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="es-module">ES Module</h2> <ol><li>输出 export，使用import</li> <li>import 会提升到真个页面的头部执行</li> <li>export的位置可以随意，但export不能再局部作用域中，因为不能静态化了，违背了es6的设计初衷</li> <li>export 导出的是变量的引用，入{a: a},随原文件值变而变，export.default导出的是一个值，不会改变</li> <li>es Module 是预加载模式，commonjs是运行时加载，且有缓存，下次执行得到的还是上次的值</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// egg1</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'a.js'</span>
<span class="token comment">//egg2</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">import</span> a <span class="token keyword">from</span> <span class="token string">'./'</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/zlc-blog/assets/js/app.6100065f.js" defer></script><script src="/zlc-blog/assets/js/44.be511023.js" defer></script>
  </body>
</html>
